"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var chai_1 = require("chai");
var data_forge_1 = require("data-forge");
require("../indicators/sma");
function rsi(period) {
    chai_1.assert.isNumber(period, "Expected 'period' parameter to 'DataFrame.rsi' to be a number that specifies the time period for computation of the relative strength index.");
    return this.rollingWindow(period + 1) // Add one to period to make for losing one (due to 'amountChange') in every window.
        .select(function (window) {
        var changes = window.amountChange(2).bake();
        var averageLoss = Math.abs(changes.select(function (change) { return change < 0 ? change : 0; }).average());
        if (averageLoss < Number.EPSILON) {
            return [
                window.getIndex().last(),
                100
            ];
        }
        var averageGain = changes.select(function (change) { return change > 0 ? change : 0; }).average();
        var relativeStrength = averageGain / averageLoss;
        return [
            window.getIndex().last(),
            100 - (100 / (1 + relativeStrength))
        ];
    })
        .withIndex(function (pair) { return pair[0]; })
        .select(function (pair) { return pair[1]; });
}
data_forge_1.Series.prototype.rsi = rsi;
//# sourceMappingURL=rsi.js.map